# 导弹移动

导弹移动系统采用视频编辑器的比喻。地图制作者可以将多达5个运动阶段依次链接在一起，通过混合进行过渡，在必要时可以添加额外的运动覆盖层到阶段顶部，以进一步定制它们的外观，类似于如何在视频流上叠加视频处理效果。

导弹通常用于配置基于导弹的攻击，但基础运动也可以用于在跳跃时驱动收割者的身体或在攻击时驱动脊刺爬行者的触手。



## 运动驱动器

每个运动阶段的核心是一个驱动器。有四种类型：

1. **引导** - 导弹在3D空间中跟随目标移动，就像标准制导导弹一样。
2. **弹道** - 导弹以抛物线轨迹飞行。

3. **抛物线** - 导致导弹采取固定的抛物线弧线，而不考虑其加速度和减速度。
4. **投掷** - 导弹沿着指定方向的任意线性路径行进。



## 运动覆盖层

覆盖层导致导弹以某种漂亮的方式沿着核心驱动路径移动。用户可以在同一驱动器上叠加多达两种不同的覆盖层，例如通过正弦波同时变化水平和垂直轴上的运动。

虽然它们会改变导弹在游戏中的实际位置，但实际上并不会改变它们下方的运动驱动器的路径。换句话说，具有正弦波运动覆盖层的制导导弹实际上有一个无形的制导路径，指导其到达目标，即使它看起来是以正弦波方式运动的。

有三种类型：

1. **波浪** - 使导弹在移动时来回摆动，呈正弦波形式。
2. **轨道** - 使导弹具有螺旋形运动，像螺旋桨一样。

3. **左轮** - 类似于轨道覆盖层，但轨道运动不总是朝着相同方向前进--它在运动轴上追踪在发射时生成的任意旋转。根据涉及的速度，这可能使导弹旋转经过目标，此时它会减速然后沿另一个方向旋转回去。



## 阶段过渡和混合

用户通过指定阶段的尾声来配置阶段的结束。尾声通过相对于源或相对于目标的“已移动距离”阈值来结束阶段。相对于源的尾声为正，相对于目标的尾声为负。

在数据中指定尾声时，必须指定“混合点”值和“停止点”值。如果这两个值相同，则一旦达到指定的尾声距离，导弹将立即切换到下一个阶段。如果这两个值不同，则运动阶段将在两个值之间混合。在混合处于激活状态时，两个阶段（当前阶段和下一个阶段）并行运行，并且它们的结果被混合在一起。一般来说，混合会导致更平滑的运动，尤其是当混合阶段的运动驱动器不同时。混合几乎总是必要的，以避免故障。



## 工作原理

与星际争霸II中的许多其他对象一样，导弹既有同步游戏部分又有异步角色部分。导弹每秒模拟其游戏状态32次，这是普通单位速率的两倍。与其他一切一样，它们在有足够时间绘制时绘制，这意味着它们可以在每次游戏循环之间绘制多次（如果游戏顺畅运行）到长时间内根本不绘制（在帧率低迫切的情况下）。导弹的游戏部分每个游戏循环模拟两次，然后将数据传输到导弹的角色侧，后者在手头的数据之间插值。在紧急帧率低迫切情况下，角色部分可能落后，此时用户会看到导弹跳跃。

由于游戏/角色分离，实际上导弹有两条飞行路径：游戏路径和角色路径。游戏路径从攻击者的原点到目标的原点。角色路径从发射附着点到着陆附着点。内部会发生一种叫做适应的过程，以确保用户在屏幕上看到的导弹跟踪基本的游戏路径，同时直接在发射和着陆附着点之间移动。

值得注意的是，运动覆盖层是同步的。这使它们能够更加戏剧化，而不会导致抽搐的运动。它们实际上会按比例减少底层驱动器运动，使得实际导弹速度（包括覆盖层）与用户指定的速度相匹配。



## 数据配置

### 相关目录

- *MoverData.xml* 用于确定导弹到达目标的路径。
- *EffectData.xml* 用于配置导弹的发射导弹效果，该效果将确定导弹的源和目标，并可选择用于导弹的移动器。

- *UnitData.xml* 为导弹分配单位，以便它可以在游戏世界中被视为可交互对象。
  
- *WeaponData.xml* 或 *AbilData.xml* 用于配置触发发射导弹效果的武器或能力。
- *ActorData.xml* 用于声明导弹的角色部分，并通过角色动作配置攻击的视觉和音频，包括选择导弹在其中移动的发射和目标附着点。

### 移动器数据编辑细节

为了最小化移动器数据输入，从一个运动阶段的数据自动传递到下一个阶段，除非在那里它是不相关的或被覆盖的。

用户以秒为单位输入时间数据，以度为单位输入角度数据。



## 详细的运动阶段

每个运动阶段都有适用于两种或两种以上阶段驱动器类型的一些通用字段，以及一系列字段，用于定制特定驱动器。它还具有一个用于变化运动覆盖层比例的小数组。

**驱动器** - 驱动整个阶段的运动类型：可调适应抛物线、弹道、引导或投掷。

**加速度** - 控制导弹加速的速度。可以是负值，以减速导弹。

**加速度范围** - 用于在基本加速度值上添加随机额外量的范围。

**速度**

阶段开始时导弹的速度。用户通常在第一个阶段上配置此值，因为在大多数情况下，导弹的实际速度在飞行时会自动传递到下一个阶段。（速度目前不会传递到弹道阶段，也不会传递到导弹的旋转方向不指向投掷方向的阶段中。）

该字段被弹道驱动器独特地解释为水平速度恒定。

**速度范围** - 用于在基本速度值上添加随机额外量的范围。

**最小速度** - 导弹在阶段中可能的最小速度。可用于确保减速不会完全停止导弹。
**最大速度** - 导弹在阶段中可能的最大速度。